<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Anna Syme, Torsten Seemann">
        <link rel="canonical" href="http://sepsis-omics.github.io/tutorials/modules/prokka/">
        <link rel="shortcut icon" href="favicon.ico">
        

	<title>Genome annotation - ABRPI</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/sepsis.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">ABRPI</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Monday <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../workshop_overview/">Genomics workshop overview</a>
</li>

                    
                        
<li >
    <a href="../galaxy/">Starting with Galaxy</a>
</li>

                    
                        
<li >
    <a href="../data-dna/">Training dataset</a>
</li>

                    
                        
<li >
    <a href="../fastqc/">Quality control</a>
</li>

                    
                        
<li >
    <a href="../spades/">Genome assembly</a>
</li>

                    
                        
<li class="active">
    <a href="./">Genome annotation</a>
</li>

                    
                        
<li >
    <a href="../snippy/">Variant finding</a>
</li>

                    
                        
<li >
    <a href="../abricate/">Finding antibiotic-resistant genes</a>
</li>

                    
                        
<li >
    <a href="../viral_genomes/">Viral genome sequencing</a>
</li>

                    
                        
<li >
    <a href="../kraken/">Sample identification with Kraken</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../about/">About</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../spades/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../snippy/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/sepsis-omics/tutorials">
                        
                        sepsis-omics/tutorials
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#genome-annotation-using-prokka">Genome annotation using Prokka</a></li>
        
            <li><a href="#background">Background</a></li>
        
            <li><a href="#learning-objectives">Learning objectives</a></li>
        
            <li><a href="#input-data">Input data</a></li>
        
            <li><a href="#run-prokka">Run Prokka</a></li>
        
            <li><a href="#examine-the-output">Examine the output</a></li>
        
            <li><a href="#view-annotated-features-in-jbrowse">View annotated features in JBrowse</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<p><br></p>
<h1 id="genome-annotation-using-prokka">Genome annotation using Prokka</h1>
<p>Keywords: annotation, Prokka, JBrowse, Galaxy, Microbial Genomics Virtual Lab</p>
<h2 id="background">Background</h2>
<p>In this section we will use a software tool called Prokka to annotate the draft genome sequence produced in the previous <a href="../spades/">tutorial</a>. Prokka is a “wrapper”; it collects together several pieces of software (from various authors), and so avoids “re-inventing the wheel”.</p>
<p>Prokka finds and annotates features (both protein coding regions and RNA genes, i.e. tRNA, rRNA) present on on a sequence. Note, Prokka uses a two-step process for the annotation of protein coding regions: first, protein coding regions on the genome are identified using <a href="http://prodigal.ornl.gov/">Prodigal</a>; second, the <em>function</em> of the encoded protein is predicted by similarity to proteins in one of many protein or protein domain databases. Prokka is a software tool that can be used to annotate bacterial, archaeal and viral genomes quickly, generating standard output files in GenBank, EMBL and gff formats. More information about Prokka can be found <a href="https://github.com/tseemann/prokka">here</a>.</p>
<h2 id="learning-objectives">Learning objectives</h2>
<p>At the end of this tutorial you should be able to:</p>
<ol>
<li>load a genome assembly into Prokka</li>
<li>annotate the assembly using Prokka</li>
<li>examine the annotated genome using JBrowse</li>
</ol>
<h2 id="input-data">Input data</h2>
<p>Prokka requires assembled contigs.</p>
<ul>
<li>
<p>If you are continuing on from the previous workshop (<a href="../spades/">Assembly with Spades</a>), this file will be in your current history: <fn>SPAdes_contigs.fasta</fn>.</p>
</li>
<li>
<p>Alternatively, get the file called &ldquo;assembled contigs&rdquo; from the <a href="../data-dna/">Training dataset page.</a></p>
</li>
</ul>
<!--
We will import a history from Galaxy:

- In the menu options across the top, go to <ss>Shared Data</ss>.
- Click on <ss>Histories</ss>.
- A list of published histories should appear. Click on <fn>GCC 2016 small genome annotation</fn>.
- Click on <ss>Import history</ss>.
- An option will appear to re-name the history. We don't need to rename it, so click <ss>Import</ss>.
- The history will now appear in your Current History pane, and the <fn>SPAdes_contigs.fasta</fn> file is now ready to use in Galaxy analyses.
-->

<h2 id="run-prokka">Run Prokka</h2>
<ul>
<li>In Galaxy, go to <ss>Tools &rarr; NGS Analysis &rarr; NGS: Annotation &rarr; Prokka</ss>  </li>
<li>Set the following parameters (leave everything else unchanged):<ul>
<li><ss>Contigs to annotate</ss>: <fn>SPAdes contigs (fasta)</fn>  </li>
<li><ss>Locus tag prefix (&ndash;locustag)</ss>: P</li>
<li><ss>Force GenBank/ENA/DDJB compliance (&ndash;compliant)</ss>: <em>No</em></li>
<li><ss>Sequencing Centre ID (&ndash;centre)</ss>: V</li>
<li><ss>Genus Name</ss>: <em>Staphylococcus</em>  </li>
<li><ss>Species Name</ss>: <em>aureus</em>  </li>
<li><ss>Use genus-specific BLAST database</ss> <em>No</em>  </li>
</ul>
</li>
</ul>
<p>Your tool interface should look like this:</p>
<p><img alt="prokka interface" src="./images/interface.png" /></p>
<ul>
<li>Click <ss>Execute</ss>  </li>
</ul>
<h2 id="examine-the-output">Examine the output</h2>
<!-- First, enable *Scratchbook* in Galaxy - this allows you to view several windows simultaneously. Click on the 3&times;3 squares icon on the menu bar:

![scratchbook icon](images/scratchbook.png)
-->

<p>Once Prokka has finished, examine each of its output files.</p>
<ul>
<li>The <fn>GFF</fn> and <fn>GBK</fn> files contain all of the information about the features annotated (in different formats.)</li>
<li>The <fn>.txt</fn> file contains a summary of the number of features annotated.</li>
<li>The <fn>.faa</fn> file contains the protein sequences of the genes annotated.</li>
<li>The <fn>.ffn</fn> file contains the nucleotide sequences of the genes annotated.</li>
</ul>
<h2 id="view-annotated-features-in-jbrowse">View annotated features in JBrowse</h2>
<p>Now that we have annotated the draft genome sequence, we would like to view the sequence in the JBrowse genome viewer.</p>
<ul>
<li>
<p>Go to <ss>Statistics and Visualisation &rarr; Graph/Display Data &rarr; JBrowse genome browser</ss>.</p>
</li>
<li>
<p>Under <ss>Reference genome to display</ss> choose <em>Use a genome from history</em>.</p>
</li>
<li>
<p>Under <ss>Select the reference genome</ss> choose <fn>Prokka on data XX:fna</fn>. This .fna sequence is the fasta nucleotide sequence, and will be the reference against which annotations are displayed.</p>
</li>
<li>
<p>For <ss>Produce a Standalone Instance</ss> select <em>Yes</em>.</p>
</li>
<li>
<p>For <ss>Genetic Code</ss> choose <em>11: The Bacterial, Archaeal and Plant Plastid Code</em>.</p>
</li>
<li>
<p>Under <ss>JBrowse-in-Galaxy Action</ss> choose <em>New JBrowse Instance</em>.</p>
</li>
<li>
<p>Click <ss>Insert Track Group</ss></p>
</li>
<li>
<p>Under <ss>Track Category</ss> type in <em>gene annotations</em>.</p>
</li>
<li>
<p>Click <ss>Insert Annotation Track</ss></p>
</li>
<li>
<p>For <ss>Track Type</ss> choose <em>GFF/GFF3/BED/GBK Features</em></p>
</li>
<li>
<p>For <ss>GFF/GFF3/BED Track Data</ss> select <fn>Prokka on data XX:gff</fn>  [Note: not wildtype.gff]</p>
</li>
<li>
<p>Under <ss>JBrowse Track Type[Advanced]</ss> select <em>Canvas Features</em>.</p>
</li>
<li>
<p>Click on <ss>JBrowse Styling Options <Advanced]</ss></p>
</li>
<li>
<p>Under <ss>JBrowse style.label</ss> add in <em>product</em>.</p>
</li>
<li>
<p>Under <ss>Track Visibility</ss> choose <em>On for new users</em>.</p>
</li>
</ul>
<p>Your tool interface should look like this:</p>
<p><img alt="JBrowse interface" src="./images/jbrowse_int.png" /></p>
<!--
![JBrowse interface](images/jbrowse_oldversion.png) -->

<ul>
<li>
<p>Click <ss>Execute</ss></p>
</li>
<li>
<p>A new file will be created, called <fn>JBrowse on data XX and data XX - Complete</fn>. Click on the eye icon next to the file name. The JBrowse window will appear in the centre Galaxy panel.</p>
</li>
<li>
<p>Under <ss>Available Tracks</ss> on the left, tick the box for <fn>Prokka on data XX:gff</fn>.</p>
</li>
<li>
<p>Select contig 1 in the drop down box. You can only see one contig displayed at a time.</p>
</li>
</ul>
<p><img alt="JBrowse" src="./images/jbrowse5.png" /></p>
<ul>
<li>
<p>Use the plus and minus buttons to zoom in and out, and the arrows to move left or right (or click and drag within the window to move left or right).</p>
</li>
<li>
<p>Zoom in to see the reference sequence at the top. JBrowse displays the sequence and a 6-frame amino acid translation.</p>
</li>
</ul>
<p>Zoomed in view:</p>
<p><img alt="JBrowse" src="./images/jbrowse6.png" /></p>
<ul>
<li>Right click on a gene/feature annotation (the bars on the annotation track), then select <ss>View Details</ss> to see more information.<ul>
<li>gene name</li>
<li>product name</li>
<li>you can download the FASTA sequence by clicking on the disk icon.</li>
</ul>
</li>
</ul>
<!-- ## What next?

- Identify genome variants (nucletotide changes) using [Snippy](/modules/snippy/index.md).
--></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>&copy; The authors; 2016-</center>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../js/details.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>